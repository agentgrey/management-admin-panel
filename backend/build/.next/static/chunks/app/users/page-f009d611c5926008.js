(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9],{2284:(e,r,s)=>{Promise.resolve().then(s.bind(s,4893))},4893:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>D});var l=s(5155),a=s(2115),n=s(3464),t=s(9915),i=s(9670),o=s(5695),d=s(5857),c=s(5876),m=s(1063),u=s(5949),h=s(2137),x=s(3967),j=s(3470),p=s(7236),A=s(9340),f=s(5843),g=s(1384),v=s(9694),b=s(7129),w=s(2861),y=s(2966),C=s(2422),N=s(5456),E=s(95),k=s(8679),S=s(8520),B=s(9576),U=s(4752),_=s.n(U);let R=[S.z.ADMIN,S.z.EMPLOYEE,S.z.MANAGER],I=e=>{let{open:r,onClose:s,initialData:a}=e,{user:t,authConfig:i}=(0,B.A)(),o=!!a,c=(null==t?void 0:t.role)===S.z.ADMIN,m=(0,v.Wx)({enableReinitialize:!0,initialValues:{name:(null==a?void 0:a.name)||"",email:(null==a?void 0:a.email)||"",password:"",role:(null==a?void 0:a.role)||""},validationSchema:b.Ik({name:b.Yj().required("Name is required"),email:b.Yj().email("Invalid email").required("Email is required"),password:b.Yj().min(6,"Password must be at least 6 characters").when([],{is:()=>!o,then:e=>e.required("Password is required")}),role:b.Yj().required("Role is required")}),onSubmit:async(e,r)=>{let{setSubmitting:l,setErrors:t}=r;if(!c){t({role:"Only admins can perform this action."});return}try{let r="".concat("http://localhost:5000","/api/users");o?(await n.A.put("".concat(r,"/").concat(null==a?void 0:a._id),e,i),_().fire({icon:"success",title:"User Updated",text:"User ".concat(e.name," has been successfully updated!"),confirmButtonColor:"#4CAF50"})):(await n.A.post(r,e,i),_().fire({icon:"success",title:"User Created",text:"User ".concat(e.name," has been successfully created!"),confirmButtonColor:"#4CAF50"})),s()}catch(e){console.error("Error submitting user data:",e),_().fire({title:"Error!",text:"Something went wrong. Please try again.",icon:"error",confirmButtonColor:"#d33",confirmButtonText:"OK"})}finally{l(!1),s()}}});return(0,l.jsxs)(w.A,{open:r,onClose:s,fullWidth:!0,maxWidth:"sm",children:[(0,l.jsx)(y.A,{children:o?"Edit User":"Create User"}),(0,l.jsxs)("form",{onSubmit:m.handleSubmit,children:[(0,l.jsxs)(C.A,{children:[(0,l.jsx)(N.A,{fullWidth:!0,label:"Name",name:"name",value:m.values.name,onChange:m.handleChange,onBlur:m.handleBlur,error:m.touched.name&&!!m.errors.name,helperText:m.touched.name&&m.errors.name,margin:"dense"}),(0,l.jsx)(N.A,{fullWidth:!0,label:"Email",name:"email",type:"email",value:m.values.email,onChange:m.handleChange,onBlur:m.handleBlur,error:m.touched.email&&!!m.errors.email,helperText:m.touched.email&&m.errors.email,margin:"dense",disabled:o}),!o&&(0,l.jsx)(N.A,{fullWidth:!0,label:"Password",name:"password",type:"password",value:m.values.password,onChange:m.handleChange,onBlur:m.handleBlur,error:m.touched.password&&!!m.errors.password,helperText:m.touched.password&&m.errors.password,margin:"dense"}),(0,l.jsx)(N.A,{fullWidth:!0,select:!0,label:"Role",name:"role",value:m.values.role,onChange:m.handleChange,onBlur:m.handleBlur,error:m.touched.role&&!!m.errors.role,helperText:m.touched.role&&m.errors.role,margin:"dense",children:R.map(e=>(0,l.jsx)(E.A,{value:e,children:e},e))})]}),(0,l.jsxs)(k.A,{children:[(0,l.jsx)(d.A,{onClick:s,color:"secondary",children:"Cancel"}),(0,l.jsx)(d.A,{type:"submit",variant:"contained",color:"primary",disabled:!c,children:o?"Update":"Create"})]})]})]})},q=e=>{let{users:r,onDelete:s}=e;(0,o.useRouter)();let[n,t]=(0,a.useState)(!1),[i,v]=(0,a.useState)(null),b=e=>{v(e),t(!0)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(I,{open:n,onClose:()=>t(!1),initialData:i}),(0,l.jsxs)("section",{className:"mx-10 p-2",children:[(0,l.jsxs)("div",{className:"mx-2 my-5 flex justify-between items-center mt-5",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-lg font-semibold text-blue-800",children:[(0,l.jsx)(A.A,{}),(0,l.jsx)("span",{children:"All Team Members"})]}),(0,l.jsx)(d.A,{onClick:()=>{v(null),t(!0)},variant:"contained",className:"!bg-theme",startIcon:(0,l.jsx)(f.A,{}),children:"CREATE"})]}),(0,l.jsx)(c.A,{component:m.A,sx:{borderRadius:"8px"},children:(0,l.jsxs)(u.A,{children:[(0,l.jsx)(h.A,{children:(0,l.jsxs)(x.A,{sx:{backgroundColor:"#f5f5f5"},children:[(0,l.jsx)(j.A,{children:"ID"}),(0,l.jsx)(j.A,{children:"Name"}),(0,l.jsx)(j.A,{children:"Email"}),(0,l.jsx)(j.A,{children:"Role"}),(0,l.jsx)(j.A,{children:"Actions"})]})}),(0,l.jsx)(p.A,{children:r.map(e=>(0,l.jsxs)(x.A,{children:[(0,l.jsx)(j.A,{children:e._id}),(0,l.jsx)(j.A,{children:e.name}),(0,l.jsx)(j.A,{children:e.email}),(0,l.jsx)(j.A,{children:e.role}),(0,l.jsxs)(j.A,{children:[(0,l.jsx)(d.A,{variant:"contained",color:"primary",size:"small",startIcon:(0,l.jsx)(g.A,{}),onClick:()=>b(e),className:"mr-2",children:"Edit"}),(0,l.jsx)(d.A,{variant:"contained",color:"secondary",size:"small",onClick:()=>s(e._id),className:"ml-2",children:"Delete"})]})]},e._id))})]})})]})]})};var z=s(328),P=s(7994);let D=()=>{let[e,r]=(0,a.useState)([]),[s,o]=(0,a.useState)(!0),[d,c]=(0,a.useState)(null),{authConfig:m}=(0,B.A)();return(0,a.useEffect)(()=>{(async()=>{try{let e="http://localhost:5000";if(!e)throw Error("API base URL is missing from environment variables.");let s=await n.A.get("".concat(e,"/api/users"),m);Array.isArray(s.data)&&s.data.length>0?r(s.data):(console.warn("API returned an empty response"),r([]))}catch(e){c(e instanceof Error?e.message:"An unknown error occurred")}finally{o(!1)}})()},[]),console.log("users",e),(0,l.jsx)(z.default,{title:"USERS",children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"px-2 md:px-0 ml-14 mt-10 mb-10",children:(0,l.jsx)(P.default,{links:[{id:1,page:"Users Dashboard",link:"/users"}]})}),(0,l.jsx)("div",{className:"w-[95%] mx-auto my-4 -mt-5 bg-white",children:s?(0,l.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,l.jsx)(t.A,{})}):d?(0,l.jsx)(i.A,{color:"error",align:"center",children:d}):(0,l.jsx)(q,{users:e,onDelete:s=>{r(e.filter(e=>e._id!==s))}})})]})})}},7994:(e,r,s)=>{"use strict";s.d(r,{default:()=>i});var l=s(5155),a=s(8847),n=s(6874),t=s.n(n);s(2115);let i=e=>{let{links:r}=e;return(0,l.jsxs)("div",{className:"py-2 flex md:gap-4 gap-1 items-center tracking-wide flex-wrap",children:[(0,l.jsx)(t(),{href:"/",children:(0,l.jsxs)("span",{className:"md:px-4 px-2 py-1 bg-slate-50 shadow-sm rounded-full hover:shadow-lg md:text-sm text-xs font-medium text-gray-600 cursor-pointer transition-all ease-in-out duration-300",children:[(0,l.jsx)(a.A,{className:"!text-theme",fontSize:"small"})," Home"]})}),null==r?void 0:r.map(e=>(0,l.jsxs)("div",{className:"flex md:gap-4 gap-1 items-center",children:[(0,l.jsx)("span",{className:"text-black",children:"/"}),(0,l.jsx)(t(),{href:null==e?void 0:e.link,children:(0,l.jsx)("span",{className:"px-4 py-1 cursor-pointer shadow-sm bg-slate-50 rounded-full md:text-sm text-xs font-medium text-gray-600 hover:shadow-lg transition-all ease-in-out duration-300",children:null==e?void 0:e.page})})]},null==e?void 0:e.id))]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[320,939,481,464,129,933,503,973,328,441,684,358],()=>r(2284)),_N_E=e.O()}]);